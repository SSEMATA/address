<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Product Page</title>

<style>
  :root{
    --bg: #fff7f0;
    --muted: #6b6b6b;
    --accent: #ff7f00;
    --panel: #f5efe8;
    --card-border: #e8e4df;
  }

  body{
    margin:0;
    font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg, #ffffff, #fff7f0);
    color:#222;
  }

  .product-wrapper{
    max-width: 1200px;
    margin: 70px auto;
    display: flex;
    gap: 40px;
    align-items: flex-start;
    padding: 0 10px;
  }

  .left-side {
    flex: 1.3;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: flex-start;
  }

  .product-img {
    width: 100%;
    height: auto;
    max-width: 500px;
    border-radius: 22px;
    background: #fff;
    border: 1px solid rgba(0,0,0,0.07);
    padding: 14px;
    box-shadow: 0px 12px 25px rgba(0,0,0,0.10),
                0px 2px 8px rgba(0,0,0,0.06);
    object-fit: contain;
  }

  .right-side{
    flex:1;
    display:flex;
    flex-direction:column;
    justify-content:flex-start;
    padding:10px 5px;
  }

  .product-name{
    font-size:50px;
    font-weight:600;
    margin: 0 0 4px;
    letter-spacing:-0.02em;
    color:#222;
  }

  .product-desc{
    font-size:19px;
    line-height:1.55;
    color:#5a5a5a;
    margin-bottom:10px;
    max-width:540px;
  }

  .product-price{
    font-size:34px;
    font-weight:600;
    margin-bottom:10px;
    color:#ff7f00;
  }

  hr.divider{
    border:none;
    height:1px;
    background:#ece7e3;
    margin:28px 0;
  }

  .controls-row{
    display:flex;
    align-items:center;
    gap:18px;
    flex-wrap:wrap;
  }

  .qty-box{
    display:flex;
    align-items:center;
    background:#fff;
    border-radius:12px;
    border:1px solid var(--card-border);
    padding:10px 20px;
    min-width:170px;
    justify-content:center;
    gap:18px;
    box-shadow:0 3px 6px rgba(0,0,0,0.04);
  }

  .qty-btn{
    background:transparent;
    border:none;
    font-size:22px;
    width:28px;
    height:28px;
    color:var(--muted);
    cursor:pointer;
  }

  #quantity{
    font-size:20px;
    font-weight:600;
  }

  .order-btn{
    display:flex;
    align-items:center;
    gap:12px;
    background-color: #ff7f00;
    border: 1px solid rgba(0,0,0,0.03);
    color:#fff;
    padding:14px 26px;
    border-radius:12px;
    font-weight:600;
    font-size:18px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    cursor:pointer;
  }

  .wishlist{
    width:56px;
    height:56px;
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    border:1px solid var(--card-border);
    background:#fff;
    font-size:22px;
    color:#c9bba8;
    cursor:pointer;
  }

  #foodDropdown label{
    display:block;
    margin-bottom:2px;
    cursor:pointer;
    font-size:16px;
  }

  #foodDropdown hr{ margin:5px 0; }

  #selectedList{
    margin-top: 8px;
    font-size: 15px;
    color: #333;
  }

  #doneBtn{
    display:block;
    margin-top: 10px;
    background: #ff7f00;
    color: #fff;
    border:none;
    padding:8px 12px;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
  }

  @media (max-width: 768px){
    .product-wrapper{
      flex-direction:column;
      gap:26px;
      padding:16px;
      text-align:left;
    }

    .product-img{ width:95%; max-height:400px; }
    .product-name{ font-size:30px; }
    .product-desc{ font-size:17px; }
    .product-price{ font-size:32px; }
  }
</style>
</head>
<body>

<div class="product-wrapper">

  <div class="left-side">
    <img class="product-img" id="productImg" src="" alt="Product Image">
  </div>

  <div class="right-side">
    <p class="product-name" id="productName">Product Name</p>
    <p class="product-desc" id="productDesc">
      Loading description...
    </p>

    <div style="display:flex; flex-direction:column; gap:4px; position:relative;">
      <div style="display:flex; align-items:center; gap:20px;">
        <p class="product-price" id="productPrice" style="margin-bottom: 30px;">0 USh</p>
        <button id="addFoodBtn" class="order-btn" style="background:#ffa500; font-size:16px; padding:10px 18px; margin-bottom: 2px;  border-radius: 0;">âž• Add Food</button>
      </div>

      <div id="selectedList">You have selected: None</div>

      <div id="foodDropdown" style="
        display: none;
        position: absolute;
        top:50px;
        left:0;
        background: #fff;
        border: 1px solid #e8e4df;
        border-radius: 12px;
        padding: 10px;
        width: 250px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        z-index: 10;">
        <div style="text-align:right; cursor:pointer; font-weight:bold;" id="closeDropdown">X</div>
        <label><input type="checkbox" id="selectAll"> Select All</label>
        <hr>
        <label><input type="checkbox" class="foodOption" value="Yams"> Yams</label>
        <label><input type="checkbox" class="foodOption" value="Matooke"> Matooke</label>
        <label><input type="checkbox" class="foodOption" value="Rice"> Rice</label>
        <label><input type="checkbox" class="foodOption" value="Kalo"> Kalo</label>
        <label><input type="checkbox" class="foodOption" value="Greens"> Greens</label>
        <label><input type="checkbox" class="foodOption" value="Cassava"> Cassava</label>
        <label><input type="checkbox" class="foodOption" value="Sweetpotatoes"> Sweetpotatoes</label>
        <button id="doneBtn">Done</button>
      </div>
    </div>

    <hr class="divider">

    <div class="controls-row">
      <div class="qty-box">
        <button class="qty-btn" onclick="changeQty(-1)">âˆ’</button>
        <span id="quantity">1</span>
        <button class="qty-btn" onclick="changeQty(1)">+</button>
      </div>

      <button class="order-btn" onclick="orderNow()" style=" border-radius: 0;">
        ðŸ›’ <span>Order</span>
      </button>

      <div class="wishlist">â™¡</div>
    </div>
  </div>
</div>

<script>
  // Load the selected product from localStorage
  const product = JSON.parse(localStorage.getItem('selectedProduct')) || {
    name:'Sample Product',
    price:5000,
    img:'https://via.placeholder.com/500',
    desc:'Default product description.'
  };

  // Fill in all product details dynamically
  document.getElementById('productName').innerText = product.name;
  document.getElementById('productPrice').innerText = product.price + " USh";
  document.getElementById('productImg').src = product.img;
  document.getElementById('productDesc').innerText =
    product.desc && product.desc.trim() !== ""
      ? product.desc
      : "Add here Your description.";

  // Quantity controls
  let qty = 1;
  function changeQty(val){
    qty += val;
    if(qty < 1) qty = 1;
    document.getElementById('quantity').innerText = qty;
  }

  // Dropdown logic
  const addFoodBtn = document.getElementById('addFoodBtn');
  const foodDropdown = document.getElementById('foodDropdown');
  const closeDropdown = document.getElementById('closeDropdown');
  const selectAll = document.getElementById('selectAll');
  const foodOptions = document.querySelectorAll('.foodOption');
  const selectedList = document.getElementById('selectedList');
  const doneBtn = document.getElementById('doneBtn');

  function updateSelectedList(){
    const selectedFoods = Array.from(document.querySelectorAll('.foodOption:checked')).map(f => f.value);
    selectedList.innerText = "You have selected: " + (selectedFoods.length ? selectedFoods.join(', ') : 'None');
  }

  const addFoodSection = document.getElementById('addFoodBtn').parentElement;
  const allowedFoods = ['Beef Pilau', 'Chicken Pilau']; // customize your allowed food types

  if (!allowedFoods.includes(product.name)) {
    addFoodSection.style.display = 'none'; // hide Add Food button + dropdown
  }

  addFoodBtn.addEventListener('click', () => {
    foodDropdown.style.display = 'block';
    updateSelectedList();
  });

  closeDropdown.addEventListener('click', () => foodDropdown.style.display = 'none');
  doneBtn.addEventListener('click', () => foodDropdown.style.display = 'none');

  selectAll.addEventListener('change', () => {
    foodOptions.forEach(opt => opt.checked = selectAll.checked);
    updateSelectedList();
  });

  foodOptions.forEach(opt => {
    opt.addEventListener('change', updateSelectedList);
  });

  document.addEventListener('click', function(e){
    if(!foodDropdown.contains(e.target) && e.target !== addFoodBtn){
      foodDropdown.style.display = 'none';
    }
  });

  // Function to add product to cart and redirect to cart page
  function orderNow(){
    const selectedFoods = Array.from(document.querySelectorAll('.foodOption:checked')).map(f => f.value);

    const cartItem = {
      id: product.name, // using name as unique id
      name: product.name,
      price: product.price,
      image: product.img,
      quantity: qty,
      extras: selectedFoods
    };

    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    const existingItem = cart.find(item => item.id === cartItem.id);
    if(existingItem){
      existingItem.quantity += cartItem.quantity;
      existingItem.extras = cartItem.extras; // update extras if changed
    } else {
      cart.push(cartItem);
    }

    localStorage.setItem("cart", JSON.stringify(cart));

    // Redirect to cart summary page
    window.location.href = "cart.html";
  }
</script>

<script src="cartWidget.js"></script>

</body>
</html>
